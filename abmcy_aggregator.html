<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finaliser le Paiement - ABMCY MARKET</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --gold-color: #D4AF37; }
        .font-montserrat { font-family: 'Montserrat', sans-serif; }
        .text-gold { color: var(--gold-color); }
        .bg-gold { background-color: var(--gold-color); }
        .border-gold { border-color: var(--gold-color); }
    </style>
</head>
<body class="bg-gray-100 font-montserrat flex items-center justify-center min-h-screen p-4">

    <main id="payment-container" class="w-full max-w-md mx-auto">
        <div class="bg-white p-8 rounded-lg shadow-lg text-center">
            
            <a href="index.html" class="inline-block mb-6">
                <img src="logo/l.svg" alt="ABMCY MARKET Logo" class="h-10 mx-auto">
            </a>

            <h1 class="text-2xl font-bold text-gray-800 mb-2">Finalisez votre paiement</h1>
            <p class="text-gray-600 mb-6">Veuillez vérifier les informations et cliquer sur le bouton pour payer.</p>
            
            <!-- Conteneur pour les détails de la commande -->
            <div class="bg-gray-50 p-6 rounded-md mb-8 border">
                <p class="text-sm text-gray-500">Montant à payer</p>
                <p id="order-amount" class="text-4xl font-bold text-gold my-2">Chargement...</p>
                <p class="text-xs text-gray-500">Commande N° <span id="order-id" class="font-mono">...</span></p>
            </div>
            
            <!-- Conteneur pour le logo du fournisseur de paiement -->
            <div id="provider-logo-container" class="flex items-center justify-center mb-6 h-10">
                <!-- Le logo sera injecté ici -->
            </div>

            <!-- Bouton de paiement (qui est un lien) -->
            <a id="pay-button" href="#" class="w-full block bg-blue-600 text-white font-bold py-4 px-4 rounded-lg hover:bg-blue-700 transition text-lg">
                Payer maintenant
            </a>
            
            <div id="status-message" class="mt-4 text-sm font-semibold"></div>
            
            <div class="mt-8 text-xs text-gray-400">
                <p>En cliquant sur "Payer maintenant", vous serez redirigé vers l'application ou le site sécurisé de notre partenaire pour finaliser la transaction.</p>
            </div>
        </div>
    </main>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // 1. Récupérer les éléments du DOM
            const orderAmountEl = document.getElementById('order-amount');
            const orderIdEl = document.getElementById('order-id');
            const payButton = document.getElementById('pay-button');
            const statusMessage = document.getElementById('status-message');
            const logoContainer = document.getElementById('provider-logo-container');
            const paymentContainer = document.getElementById('payment-container');

            // 2. Lire les paramètres depuis l'URL
            const params = new URLSearchParams(window.location.search);
            const orderId = params.get('orderId');
            const amount = params.get('amount');
            const provider = params.get('provider');

            // 3. Valider les paramètres
            if (!orderId || !amount || !provider) {
                paymentContainer.innerHTML = `
                    <div class="bg-white p-8 rounded-lg shadow-lg text-center">
                        <h1 class="text-2xl font-bold text-red-600 mb-4">Erreur</h1>
                        <p class="text-gray-700">Les informations de paiement sont invalides ou manquantes. Veuillez retourner à la boutique et réessayer.</p>
                        <a href="index.html" class="mt-6 inline-block bg-gray-800 text-white font-bold py-2 px-4 rounded-lg">Retour à l'accueil</a>
                    </div>`;
                return;
            }

            // 4. Afficher les informations sur la page
            orderAmountEl.textContent = `${Number(amount).toLocaleString('fr-FR')} F CFA`;
            orderIdEl.textContent = `#${orderId}`;

            // 5. Configurer le lien de paiement et le logo en fonction du fournisseur
            let paymentUrl = '#';
            let logoHtml = '';

            switch (provider) {
                case 'wave':
                    // URL de paiement spécifique à Wave
                    paymentUrl = `https://pay.wave.com/m/M_sn_J3jR9Wg9ilPF/c/sn/?amount=${amount}`;
                    logoHtml = '<img src="https://www.wave.com/img/nav-logo.png" alt="Wave" class="h-8">';
                    payButton.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                    payButton.classList.add('bg-blue-500', 'hover:bg-blue-600'); // Couleur de Wave
                    break;
                case 'orange-money':
                    // REMPLACER par la véritable URL de paiement d'Orange Money
                    paymentUrl = `https://api.orange.com/orange-money-webpay/sn/v1/webpayment?order_id=${orderId}&amount=${amount}`;
                    logoHtml = '<img src="https://www.orange-sonatel.com/wp-content/uploads/2022/09/Orange-Money-logo.jpg" alt="Orange Money" class="h-8">';
                    payButton.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                    payButton.classList.add('bg-orange-500', 'hover:bg-orange-600');
                    break;
                // Ajoutez d'autres cas pour 'free-money', etc.
                default:
                    statusMessage.textContent = `Fournisseur de paiement "${provider}" non reconnu.`;
                    payButton.style.display = 'none'; // Cacher le bouton si le fournisseur est inconnu
            }

            // 6. Mettre à jour le bouton de paiement et le logo
            payButton.href = paymentUrl;
            logoContainer.innerHTML = logoHtml;
        });
    </script>
</body>
</html>